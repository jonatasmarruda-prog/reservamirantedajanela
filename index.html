<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Morro da Mesa</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{margin:0;background:#0b0b0b;font-family:Poppins,sans-serif;color:#fff}
.container{max-width:480px;margin:auto;padding:15px}
.card{background:#141414;border-radius:22px;padding:18px;box-shadow:0 0 25px rgba(0,0,0,.7)}
.banner img{width:100%;border-radius:18px;margin-bottom:15px}
.titulo{text-align:center;font-size:22px;font-weight:700}
.descricao{font-size:14px;color:#ddd;margin:10px 0}
.box-info{background:#1f1f1f;padding:12px;border-radius:14px;margin-bottom:15px}
label{display:block;margin-top:10px;font-weight:600}
input,select{width:100%;padding:14px;border-radius:14px;border:none;background:#2a2a2a;color:#fff}
.contador{display:flex;justify-content:space-between;align-items:center}
.contador button{width:45px;height:45px;border:none;border-radius:12px;background:#333;color:#fff;font-size:22px}
.info{text-align:center;margin-top:10px}
.alerta{color:#ffcc00;font-weight:bold;text-align:center;display:none}
.esgotado{background:#550000;padding:12px;border-radius:12px;text-align:center;display:none}
.btn{width:100%;margin-top:14px;padding:18px;border-radius:50px;border:none;font-size:18px;font-weight:700;color:#fff}
.pix{background:linear-gradient(135deg,#00ff9c,#00c96b)}
.whats{background:linear-gradient(135deg,#25d366,#1ebd5c);display:none}
</style>

<script>
const PIX = "trilheiros.roomt@gmail.com";
const LINK_CARTAO = "https://mpago.li/1Hafude";
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyxFuu5T6hXRvL_mSEo9a69lb5_Lb4qc7Fez0p8MEJeIHQf0laVtr8gdnUgJrBsZ5xf/exec";

// VAGAS FIXAS
let vagasOnibus = localStorage.getItem("vagasOnibus");
let vagasCarro  = localStorage.getItem("vagasCarro");

if(vagasOnibus === null){ vagasOnibus = 44; localStorage.setItem("vagasOnibus",44); }
if(vagasCarro === null){ vagasCarro = 36; localStorage.setItem("vagasCarro",36); }

vagasOnibus = parseInt(vagasOnibus);
vagasCarro = parseInt(vagasCarro);

let qtd = 1;

function atualizar(){
  infoVagas.innerHTML = `
    üöå Vagas √¥nibus: <b>${vagasOnibus}</b><br>
    üöó Vagas carro pr√≥prio: <b>${vagasCarro}</b>
  `;

  total.innerText = "üí∞ Total: R$ " + ((tipoTransporte.value==="onibus"?85:25)*qtd);

  if(
    (tipoTransporte.value==="onibus" && vagasOnibus<=0) ||
    (tipoTransporte.value==="carro" && vagasCarro<=0)
  ){
    btnReservar.style.display="none";
    esgotado.style.display="block";
  }else{
    btnReservar.style.display="block";
    esgotado.style.display="none";
  }
}

function mais(){qtd++;quantidade.innerText=qtd;atualizar();}
function menos(){if(qtd>1){qtd--;quantidade.innerText=qtd;atualizar();}}

function reservar(){
  const nome = document.getElementById("nome").value.trim();
  const tipo = tipoTransporte.value;
  const pagamento = formaPagamento.value;

  if(!nome) return alert("Digite seu nome.");

  if(tipo==="onibus" && qtd>vagasOnibus)
    return alert("Sem vagas no √¥nibus.");

  if(tipo==="carro" && qtd>vagasCarro)
    return alert("Sem vagas no carro.");

  if(tipo==="carro" && pagamento==="cartao")
    return alert("Carro pr√≥prio aceita apenas PIX.");

  if(tipo==="onibus" && pagamento==="cartao" && qtd>1)
    return alert("Para mais de uma vaga no cart√£o, fale com o Jonatas.");

  if(tipo==="onibus") vagasOnibus -= qtd;
  else vagasCarro -= qtd;

  localStorage.setItem("vagasOnibus",vagasOnibus);
  localStorage.setItem("vagasCarro",vagasCarro);

  fetch(SCRIPT_URL,{
    method:"POST",
    body:JSON.stringify({
      nome:nome,
      transporte:tipo,
      quantidade:qtd,
      pagamento:pagamento,
      valor:(tipo==="onibus"?85:25)*qtd
    })
  });

  if(pagamento==="pix"){
    navigator.clipboard.writeText(PIX);
    alert("PIX copiado!");
  } else {
    window.open(LINK_CARTAO,"_blank");
  }

  btnWhats.style.display="block";
  atualizar();
}

function enviarWhats(){
  const nome=document.getElementById("nome").value;
  const tipo=tipoTransporte.value;
  const valor=(tipo==="onibus"?85:25)*qtd;

  const msg=`Ol√°! üëã
Nome: ${nome}
Transporte: ${tipo}
Vagas: ${qtd}
Valor: R$ ${valor}`;

  window.open("https://wa.me/5566996926174?text="+encodeURIComponent(msg));
}
</script>
</head>

<body>
<div class="container">
<div class="card">

<div class="banner">
<img src="https://i.postimg.cc/FzLnkVc2/Orange-and-Black-Modern-Mountain-Bike-Event-Instagram-Post.png">
</div>

<div class="titulo">‚õ∞Ô∏è Subida do Morro da Mesa</div>

<div class="descricao">
üìÖ 22 de fevereiro ‚Ä¢ ‚è∞ 02h<br>
üë£ 4 km ‚Ä¢ ‚ö†Ô∏è N√≠vel m√©dio
</div>

<div class="box-info">
‚òï Levar caf√© ‚Ä¢ ‚ôªÔ∏è Levar lixo<br>
üö´ N√£o indicado para iniciantes<br>
‚úÖ Seguro incluso
</div>

<label>Nome</label>
<input id="nome">

<label>Transporte</label>
<select id="tipoTransporte" onchange="atualizar()">
  <option value="onibus">üöå √înibus ‚Äì R$ 85</option>
  <option value="carro">üöó Carro pr√≥prio ‚Äì R$ 25</option>
</select>

<label>Quantidade</label>
<div class="contador">
<button onclick="menos()">‚àí</button>
<span id="quantidade">1</span>
<button onclick="mais()">+</button>
</div>

<div id="infoVagas" class="info"></div>
<div id="total" class="total"></div>

<label>Pagamento</label>
<select id="formaPagamento">
  <option value="pix">üíö PIX</option>
  <option value="cartao">üí≥ Cart√£o (√¥nibus)</option>
</select>

<button id="btnReservar" class="btn pix" onclick="reservar()">CONFIRMAR PAGAMENTO</button>

<div id="esgotado" class="esgotado">‚ùå VAGAS ESGOTADAS</div>

<button id="btnWhats" class="btn whats" onclick="enviarWhats()">ENVIAR COMPROVANTE</button>

</div>
</div>

<script>atualizar();</script>
</body>
</html>
